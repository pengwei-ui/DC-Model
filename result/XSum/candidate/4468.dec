Left-wing parties have won mayoral elections in Madrid, Barcelona and Valencia, ending decades of rule by the centre-right Popular Party . 

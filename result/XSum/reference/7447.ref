A UN conference aimed at preventing the proliferation of nuclear weapons has ended in failure after a row over a nuclear-free Middle East proposal . 
